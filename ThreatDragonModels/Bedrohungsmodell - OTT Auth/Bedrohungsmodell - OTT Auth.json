{
  "summary": {
    "title": "Bedrohungsmodell - OTT Auth",
    "owner": "Firma Allsecure",
    "description": "Die Firma Allsecure betreibt unterschiedliche Anwendungen mit Hilfe einer 2-Faktorauthentifizierung via One-time token, der an das entsprechende Smartphone des Nutzers geschickt wird."
  },
  "detail": {
    "contributors": [
      {
        "name": "Georg Neugebauer"
      },
      {
        "name": "Béla Struffolino"
      }
    ],
    "diagrams": [
      {
        "cells": [
          {
            "position": {
              "x": 12,
              "y": 53
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "User"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "10b549de-c410-466c-8d76-24c0ee76f275"
                },
                {
                  "group": "right",
                  "id": "85968380-0073-4d35-b7c6-3f0bf7d5b94f"
                },
                {
                  "group": "bottom",
                  "id": "a677790e-1fc9-4ef5-a148-4c3ab1b1c63a"
                },
                {
                  "group": "left",
                  "id": "57963069-b6ff-49bd-b458-98737560ebd3"
                }
              ]
            },
            "id": "dec51efb-bf55-4b9c-a294-0e45f4e823f6",
            "data": {
              "name": "User",
              "description": "",
              "type": "tm.Actor",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [],
              "hasOpenThreats": false,
              "providesAuthentication": false
            }
          },
          {
            "position": {
              "x": 280,
              "y": -6.999999999999922
            },
            "size": {
              "width": 130,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Login System -\nWebapp +\nMobile App"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "05074c14-b835-40b3-b3b3-b146bca2439a"
                },
                {
                  "group": "right",
                  "id": "230ac2c5-8335-4683-a6d1-04ab1d311877"
                },
                {
                  "group": "bottom",
                  "id": "640a5062-e4d8-45dc-8d7d-15aadcd26a13"
                },
                {
                  "group": "left",
                  "id": "8cc988a1-4f21-4509-9341-d9213d073b08"
                }
              ]
            },
            "id": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa",
            "data": {
              "name": "Login System -\nWebapp +\nMobile App",
              "description": "Vergleicht eingegebenen OTT-Wert auf Telefon mit erwartetem OTT seitens 2-Faktor-Dienst. ",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [
                {
                  "id": "2a8eb56d-ca0f-42e6-88ab-ec8be4a48976",
                  "title": "Kompromittierter Benutzer Account",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Spoofing",
                  "description": "Bedrohung: Angreifer gibt sich als legitimer Benutzer aus, indem er kompromittierte Zugangsdaten und ein abgefangenes OTT wiederverwendet.\n\nAngriffsvektor: Phishing auf Zugangsdaten, Social Engineering gegen Benutzer, OTT wird mit Malware am Smartphone abgefangen und verwendet.\n\nCAPEC-98: Phishing\nT1586: Compromise Accounts",
                  "mitigation": "Maßnahme: Multifaktor-Token-Bindung – Benutzer-Identität und OTT werden kryptographisch an ein spezifisches Endgerät und einen Session-Identifier gebunden, sodass abgefangene OTT-Tokens nicht wiederverwendet werden können.\n\nTechnisch: Beim Login generiert der 2FA-Dienst einen Session-Hash aus Benutzer, Gerät und nonce. OTT wird auf dem Gerät erzeugt und signiert. Login akzeptiert den OTT nur, wenn Session-Bindung passt.\n\nRisikoreduktion: Erneutes Verwenden von abgefangenen OTT-Tokens ist praktisch nicht mehr möglich.\n\nMASTG-KNOW-0034: Device Binding",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 103,
                  "score": "9"
                }
              ],
              "hasOpenThreats": false,
              "isWebApplication": null,
              "handlesCardPayment": null,
              "handlesGoodsOrServices": null,
              "threatFrequency": {
                "spoofing": 2,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": -1,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 630,
              "y": -330
            },
            "size": {
              "width": 130,
              "height": 140
            },
            "attrs": {
              "text": {
                "text": "2-Faktor-Authe\nntifizierungsdi\nenst"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "095eea8a-ba96-429a-810b-e463a93aa9d1"
                },
                {
                  "group": "right",
                  "id": "fa19d844-8dab-4a05-86df-5ae8cdfe616b"
                },
                {
                  "group": "bottom",
                  "id": "a0195888-9646-49d8-a15d-3082bf4beaaf"
                },
                {
                  "group": "left",
                  "id": "65029f7e-e502-41c4-9ee2-10c5f02776ac"
                }
              ]
            },
            "id": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c",
            "data": {
              "name": "2-Faktor-Authe\nntifizierungsdi\nenst",
              "description": "",
              "type": "tm.Process",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [],
              "hasOpenThreats": false,
              "isBidirectional": false,
              "protocol": "",
              "isEncrypted": false,
              "isPublicNetwork": false,
              "handlesCardPayment": null,
              "isWebApplication": null,
              "handlesGoodsOrServices": null
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "1. Auth Challenge",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Login"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "35f9f840-c060-4c31-bf9a-0e17a95ddf66",
            "source": {
              "cell": "dec51efb-bf55-4b9c-a294-0e45f4e823f6"
            },
            "target": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "vertices": [
              {
                "x": 237,
                "y": 39
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Erwarteter OTT",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "1. Auth Challenge"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "2503a360-01b6-4464-b35f-42c6fb583348",
            "source": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "target": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "vertices": [
              {
                "x": 550,
                "y": -70
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "2. Weiterleitung\nTelefonnummer",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Erwarteter OTT"
                  }
                },
                "position": 0.5
              }
            ],
            "id": "63356151-e316-4a82-8224-9a7c729cfbee",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "target": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa"
            },
            "vertices": [
              {
                "x": 490,
                "y": -140
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Log(Login, OTT, Phone Number)",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Log(Login, OTT, Phone Number)"
            ],
            "id": "81c8482c-19ed-41ab-bae2-a5561223b4b5",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c"
            },
            "target": {
              "cell": "c2716661-ef88-48a8-8d0f-724e1923d562"
            },
            "vertices": [
              {
                "x": 560,
                "y": -350
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "SIEM Event: 2FA",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "d2a40b48-03bc-494d-a2df-e94ed5088394",
                  "title": "Events abfangen",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Information disclosure",
                  "description": "Bedrohung: Interner Angreifer liest SIEM-Events und erhält sensible Account-Informationen.\n\nAngriffsvektor: Unberechtigter Zugriff auf Events über internes SIEM-Interface oder Debug-Endpunkte, Event-Payload auslesen.\n\nCAPEC-36: Using Unpublished Interfaces or Functionality\nT1087: Account Discovery",
                  "mitigation": "Maßnahme: Least-Privilege-SIEM-Zugriffsmodell – Nur Rollen mit zwingendem Bedarf können SIEM-Events lesen.\n\nTechnisch: RBAC mit strengen Rollenprofilen. Zugriff über privilegierten Proxy, also kein direkter Datenbankzugriff. Regelmäßige Rezertifizierung.\n\nRisikoreduktion: Einsichtnahme durch unbefugte Benutzer wird stark eingeschränkt.\n\nASVS V8: Authorization",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 106,
                  "score": "8"
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "SIEM Event: 2FA"
            ],
            "id": "1f5f024d-d484-422b-a9b2-daa09ebbb768",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c",
              "port": "a0195888-9646-49d8-a15d-3082bf4beaaf"
            },
            "target": {
              "cell": "1b3dea2f-d5de-434a-a61c-61da5fad4c4f",
              "port": "22d34ad1-ef4f-452a-83fa-5f1aa619d405"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "SIEM Event: OTT",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "SIEM Event: OTT"
            ],
            "id": "418fa31b-eb52-4293-a016-b8bd94e30893",
            "source": {
              "cell": "c2b3b875-5978-47bb-8d40-b67a4726470e",
              "port": "6c8c719b-179c-409a-91d4-76554b844e8a"
            },
            "target": {
              "cell": "1b3dea2f-d5de-434a-a61c-61da5fad4c4f",
              "port": "1c45959b-ba24-4ecb-9dad-24cfccd9c690"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "SIEM Event: Login",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "SIEM Event: Login"
            ],
            "id": "78f60857-f718-40b1-bd68-a157e5a4724c",
            "source": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa",
              "port": "230ac2c5-8335-4683-a6d1-04ab1d311877"
            },
            "target": {
              "cell": "1b3dea2f-d5de-434a-a61c-61da5fad4c4f",
              "port": "22d34ad1-ef4f-452a-83fa-5f1aa619d405"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "SIEM Log (Event)",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "SIEM Log (Event)"
            ],
            "id": "0064ecc1-9a2d-4a6d-9cc7-eb2b8e58579e",
            "source": {
              "cell": "1b3dea2f-d5de-434a-a61c-61da5fad4c4f",
              "port": "6c8c719b-179c-409a-91d4-76554b844e8a"
            },
            "target": {
              "cell": "e8c5d9aa-b733-4ef9-bda9-b43e67438b71",
              "port": "d843157a-2d71-4fec-ab48-b65ca6092167"
            },
            "vertices": [
              {
                "x": 810,
                "y": 230
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "OTT",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "OTT"
            ],
            "id": "353a631d-83e0-4bf9-bc59-a90f9c737cff",
            "source": {
              "cell": "c2b3b875-5978-47bb-8d40-b67a4726470e",
              "port": "22d34ad1-ef4f-452a-83fa-5f1aa619d405"
            },
            "target": {
              "cell": "a1d5bbe6-465f-43bb-bd96-7ce687db37aa",
              "port": "640a5062-e4d8-45dc-8d7d-15aadcd26a13"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Report per E-Mail (signiert)",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Report per E-Mail (signiert)"
            ],
            "id": "144137e1-f30b-4235-a88a-886389301c3f",
            "source": {
              "cell": "1b3dea2f-d5de-434a-a61c-61da5fad4c4f",
              "port": "081ba629-3d33-42e5-a6aa-3d14a9f4865d"
            },
            "target": {
              "cell": "8d3ffad1-ea75-4ec6-bdff-f6467b7c5ee6",
              "port": "10b549de-c410-466c-8d76-24c0ee76f275"
            },
            "vertices": []
          },
          {
            "shape": "trust-broundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Externer Service für T\nelefonnummernauflö\nsung",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              {
                "attrs": {
                  "label": {
                    "text": "Firma Allsecure"
                  }
                },
                "position": {
                  "distance": 0,
                  "offset": 25.336937022630487
                }
              }
            ],
            "id": "8c690a8a-f100-4c4d-bd88-095a530ac220",
            "source": {
              "x": 250,
              "y": 330
            },
            "target": {
              "x": 250,
              "y": 330
            },
            "vertices": [
              {
                "x": 460,
                "y": 470
              },
              {
                "x": 970,
                "y": 400
              },
              {
                "x": 860,
                "y": -310
              },
              {
                "x": 320,
                "y": -400
              },
              {
                "x": 200,
                "y": 110
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "2. OTT",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "2. OTT"
            ],
            "id": "a01584d7-561d-41f3-a3b4-3c282392d743",
            "source": {
              "cell": "94f68ce7-aa88-45a4-ba41-c0b62d6a959c",
              "port": "a0195888-9646-49d8-a15d-3082bf4beaaf"
            },
            "target": {
              "cell": "c2b3b875-5978-47bb-8d40-b67a4726470e",
              "port": "22d34ad1-ef4f-452a-83fa-5f1aa619d405"
            },
            "vertices": [
              {
                "x": 560,
                "y": 60
              }
            ]
          },
          {
            "position": {
              "x": 360,
              "y": -290
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Log-DB"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 11,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4f2cf6a2-5c85-4c0b-a42d-6a906c0872d0"
                },
                {
                  "group": "right",
                  "id": "0310ab41-24fe-40b4-9753-555d18bb289f"
                },
                {
                  "group": "bottom",
                  "id": "fad9fb9a-9411-420c-96b9-d3853359404d"
                },
                {
                  "group": "left",
                  "id": "d843157a-2d71-4fec-ab48-b65ca6092167"
                }
              ]
            },
            "id": "c2716661-ef88-48a8-8d0f-724e1923d562",
            "data": {
              "type": "tm.Store",
              "name": "Log-DB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "isALog": true,
              "storesCredentials": false,
              "isEncrypted": true,
              "isSigned": true,
              "hasOpenThreats": false,
              "threats": [
                {
                  "id": "ab012afb-359e-4a9e-a030-3a617acdb0b5",
                  "title": "2FA-Anfrage abstreiten",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "Bedrohung: Angreifer bestreitet nachträglich, einen 2FA-Vorgang ausgelöst zu haben.\n\nAngriffsvektor: OTT-Anfrage wird echt erzeugt, aber danach geprüft, ob der Service nicht korrekt signiert oder mit Benutzerbindung archiviert wurde, dadurch wird eine nachträgliche Zuordnung verhindert.\n\nCAPEC-173: Action Spoofing\nT1112: Modify Registry",
                  "mitigation": "Maßnahme: Ereignis-Signatur mit Benutzerbindung – Jedes 2FA-Event wird digital signiert und enthält eine eindeutige Zuordnung zur Aktion des konkreten Benutzers.\n\nTechnisch: Signatur über Benutzer, Zeitstempel, Request, Login. Validierung im SIEM bei allen Event-Verarbeitungen. Logs enthalten Signaturstatus also Validierungsbeweis.\n\nRisikoreduktion: Abstreitbarkeit ausgeschlossen, weil Events beweisbar zuordbar sind.\n\nASVS V16.2.1: General Logging",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 105,
                  "score": "7"
                }
              ],
              "storesInventory": null,
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 630,
              "y": 215
            },
            "size": {
              "width": 130,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "SIEM-System"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 12,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "22d34ad1-ef4f-452a-83fa-5f1aa619d405"
                },
                {
                  "group": "right",
                  "id": "6c8c719b-179c-409a-91d4-76554b844e8a"
                },
                {
                  "group": "bottom",
                  "id": "081ba629-3d33-42e5-a6aa-3d14a9f4865d"
                },
                {
                  "group": "left",
                  "id": "1c45959b-ba24-4ecb-9dad-24cfccd9c690"
                }
              ]
            },
            "id": "1b3dea2f-d5de-434a-a61c-61da5fad4c4f",
            "data": {
              "type": "tm.Process",
              "name": "SIEM-System",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "e441c032-5637-4dab-b425-f31b10d09028",
                  "title": "Berechtigungen eskalieren",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Elevation of privilege",
                  "description": "Bedrohung: Kompromittierter interner Angreifer mit eingeschränkten Berechtigungen eskaliert Berechtigungen auf Admin-Level, um Ereignisse zu kontrollieren.\n\nAngriffsvektor: Schwachstellen im RBAC, Umgehung von Berechtigungsprüfung, Einsatz lokaler Schwachstelle oder ungeschützter API, administrativer Vollzugriff\n\nCAPEC-233: Privilege Escalation\nT1068: Exploitation for Privilege Escalation",
                  "mitigation": "Maßnahme: Administrative Zugriffstrennung und Härtung – Administrationskonten sind physisch und logisch vom normalen Zugriff getrennt. Kritische Aktionen erfordern zwei Administratoren.\n\nTechnisch: Zwang zur 2-Personen-Autorisation für kritische Rollenänderungen. Rollentrennung durchgesetzt durch Identity-Provider.\n\nRisikoreduktion: Unbefugte Rechteausweitung erschwert und Missbrauch schneller erkennbar.\n\nASVS V2.3.5: Business Logic Security",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 108,
                  "score": "8"
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 280,
              "y": 215
            },
            "size": {
              "width": 130,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Allsecure Mobile\nPhone OTT Service"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 13,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "22d34ad1-ef4f-452a-83fa-5f1aa619d405"
                },
                {
                  "group": "right",
                  "id": "6c8c719b-179c-409a-91d4-76554b844e8a"
                },
                {
                  "group": "bottom",
                  "id": "081ba629-3d33-42e5-a6aa-3d14a9f4865d"
                },
                {
                  "group": "left",
                  "id": "1c45959b-ba24-4ecb-9dad-24cfccd9c690"
                }
              ]
            },
            "id": "c2b3b875-5978-47bb-8d40-b67a4726470e",
            "data": {
              "type": "tm.Process",
              "name": "Allsecure Mobile\nPhone OTT Service",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "64f3739a-9156-4c5e-a460-096de76a8d8f",
                  "title": "OTT Request Flooding",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "Bedrohung: Angreifer erzeugt massenhaft OTT-Anfragen, um Ressourcen zu blockieren und legitime Authentifizierungen zu verhindern.\n\nAngriffsvektor: Skript für Request an OTT-API, Überlastung der Queue, Verzögerung oder Abbruch gültiger 2FA-Versuche\n\nCAPEC-125: Flooding\nT1499: Endpoint Denial of Service",
                  "mitigation": "Maßnahme: Adaptive Rate-Limiting und DoS-Abwehr – OTT-Anfragen pro Benutzer, Gerät, IP sind adaptiv begrenzt, Missbrauch wird aktiv blockiert.\n\nTechnisch: Sliding-Window-Rate-Limiter pro Device. Wartezeiten bei verdächtigen Sequenzen. Integration in SIEM für automatische Blockierung.\n\nRisikoreduktion: Flutung des OTT-Dienstes wird abgewehrt, legitime Benutzer bleiben funktionsfähig.\n\nASVS V15.3.4: Defensive Coding",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 107,
                  "score": "9"
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 862,
              "y": 250
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "SIEM-Log-DB"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "4f2cf6a2-5c85-4c0b-a42d-6a906c0872d0"
                },
                {
                  "group": "right",
                  "id": "0310ab41-24fe-40b4-9753-555d18bb289f"
                },
                {
                  "group": "bottom",
                  "id": "fad9fb9a-9411-420c-96b9-d3853359404d"
                },
                {
                  "group": "left",
                  "id": "d843157a-2d71-4fec-ab48-b65ca6092167"
                }
              ]
            },
            "id": "e8c5d9aa-b733-4ef9-bda9-b43e67438b71",
            "data": {
              "type": "tm.Store",
              "name": "SIEM-Log-DB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "isALog": true,
              "storesCredentials": false,
              "isEncrypted": true,
              "isSigned": true,
              "hasOpenThreats": false,
              "threats": [
                {
                  "id": "b8cac1b0-7cee-4592-a0ce-ecb685fe5430",
                  "title": "Manipulierte Logs",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Tampering",
                  "description": "Bedrohung: Manipulation oder Löschung von Log-Einträgen, um missbräuchliche Anmeldungen zu vertuschen.\n\nAngriffsvektor: Privilege Escalation im SIEM-System, Änderung gespeicherter Logs über Datenbank-Interface oder direkten Schreibzugriff.\n\nCAPEC-148: Content Spoofing\nT1070: Indicator Removal",
                  "mitigation": "Maßnahme: WORM Audit-Logging – Logs können nicht gelöscht oder verändert werden, nur ergänzt. Änderungen lassen sich eindeutig nachvollziehen.\n\nTechnisch: SIEM-Logs werden versioniert und kryptographisch abgelegt. Manipulationen erzeugen Integritätsalarm. Admin-Aktionen werden nach Vier-Augen-Prinzip kontrolliert.\n\nRisikoreduktion: Manipulation von Logs praktisch nicht mehr möglich also Angriffe erkennbar.\n\nD3-FIM",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 104,
                  "score": "6"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 615,
              "y": 395
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Management"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "10b549de-c410-466c-8d76-24c0ee76f275"
                },
                {
                  "group": "right",
                  "id": "85968380-0073-4d35-b7c6-3f0bf7d5b94f"
                },
                {
                  "group": "bottom",
                  "id": "a677790e-1fc9-4ef5-a148-4c3ab1b1c63a"
                },
                {
                  "group": "left",
                  "id": "57963069-b6ff-49bd-b458-98737560ebd3"
                }
              ]
            },
            "id": "8d3ffad1-ea75-4ec6-bdff-f6467b7c5ee6",
            "data": {
              "name": "Management",
              "description": "",
              "type": "tm.Actor",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "threats": [],
              "hasOpenThreats": false,
              "providesAuthentication": false
            }
          }
        ],
        "version": "2.5.0",
        "title": "Architekturdiagramm",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "id": 0,
        "diagramType": "STRIDE"
      }
    ],
    "reviewer": "Georg Neugebauer",
    "diagramTop": 10,
    "threatTop": 108
  },
  "version": "2.5.0"
}